<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小程序基础架构 | C.AI 的文档库</title>
    <meta name="description" content="前端工程师 C.AI 的文档库">
    <link rel="icon" href="/cyz.github.io/img/logo.ico">
    
    <link rel="preload" href="/cyz.github.io/assets/css/0.styles.25a0871d.css" as="style"><link rel="preload" href="/cyz.github.io/assets/js/app.fa7d83a1.js" as="script"><link rel="preload" href="/cyz.github.io/assets/js/5.aa5682fb.js" as="script"><link rel="prefetch" href="/cyz.github.io/assets/js/10.6c776c86.js"><link rel="prefetch" href="/cyz.github.io/assets/js/11.c3a345b1.js"><link rel="prefetch" href="/cyz.github.io/assets/js/12.bd0963ae.js"><link rel="prefetch" href="/cyz.github.io/assets/js/13.d25f5ec7.js"><link rel="prefetch" href="/cyz.github.io/assets/js/14.0553bf12.js"><link rel="prefetch" href="/cyz.github.io/assets/js/15.abdbf7d0.js"><link rel="prefetch" href="/cyz.github.io/assets/js/16.dc2e8114.js"><link rel="prefetch" href="/cyz.github.io/assets/js/17.350abfb9.js"><link rel="prefetch" href="/cyz.github.io/assets/js/18.854ddd49.js"><link rel="prefetch" href="/cyz.github.io/assets/js/19.4829cccf.js"><link rel="prefetch" href="/cyz.github.io/assets/js/2.e7aea194.js"><link rel="prefetch" href="/cyz.github.io/assets/js/20.c92286a7.js"><link rel="prefetch" href="/cyz.github.io/assets/js/21.1cb5cf30.js"><link rel="prefetch" href="/cyz.github.io/assets/js/22.2a143dfb.js"><link rel="prefetch" href="/cyz.github.io/assets/js/23.496645fb.js"><link rel="prefetch" href="/cyz.github.io/assets/js/24.67ed590b.js"><link rel="prefetch" href="/cyz.github.io/assets/js/25.d262d998.js"><link rel="prefetch" href="/cyz.github.io/assets/js/26.6edfeb65.js"><link rel="prefetch" href="/cyz.github.io/assets/js/27.c18db528.js"><link rel="prefetch" href="/cyz.github.io/assets/js/28.de064934.js"><link rel="prefetch" href="/cyz.github.io/assets/js/29.40cdee03.js"><link rel="prefetch" href="/cyz.github.io/assets/js/3.06243789.js"><link rel="prefetch" href="/cyz.github.io/assets/js/30.5c0d5566.js"><link rel="prefetch" href="/cyz.github.io/assets/js/31.d972648c.js"><link rel="prefetch" href="/cyz.github.io/assets/js/32.300597bd.js"><link rel="prefetch" href="/cyz.github.io/assets/js/33.567d29ad.js"><link rel="prefetch" href="/cyz.github.io/assets/js/4.5efe0cf6.js"><link rel="prefetch" href="/cyz.github.io/assets/js/6.b4ddb395.js"><link rel="prefetch" href="/cyz.github.io/assets/js/7.b00c76d6.js"><link rel="prefetch" href="/cyz.github.io/assets/js/8.b104f469.js"><link rel="prefetch" href="/cyz.github.io/assets/js/9.2257ccac.js">
    <link rel="stylesheet" href="/cyz.github.io/assets/css/0.styles.25a0871d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/cyz.github.io/" class="home-link router-link-active"><!----> <span class="site-name">C.AI 的文档库</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/cyz.github.io/" class="nav-link">主页</a></div><div class="nav-item"><a href="/cyz.github.io/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">JS相关</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cyz.github.io/canvas/" class="nav-link">Canvas</a></li><li class="dropdown-item"><!----> <a href="/cyz.github.io/JS/" class="nav-link">Javascript语法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">CSS相关</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cyz.github.io/CSS/" class="nav-link">常用布局</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Vue相关</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cyz.github.io/VUE/" class="nav-link">基础命令</a></li><li class="dropdown-item"><!----> <a href="/cyz.github.io/VueTree/" class="nav-link">技术栈</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cyz.github.io/Applet/" class="nav-link router-link-exact-active router-link-active">小程序</a></li><li class="dropdown-item"><!----> <a href="/cyz.github.io/other/" class="nav-link">其他</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Fishcyz" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/cyz.github.io/" class="nav-link">主页</a></div><div class="nav-item"><a href="/cyz.github.io/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">JS相关</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cyz.github.io/canvas/" class="nav-link">Canvas</a></li><li class="dropdown-item"><!----> <a href="/cyz.github.io/JS/" class="nav-link">Javascript语法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">CSS相关</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cyz.github.io/CSS/" class="nav-link">常用布局</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Vue相关</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cyz.github.io/VUE/" class="nav-link">基础命令</a></li><li class="dropdown-item"><!----> <a href="/cyz.github.io/VueTree/" class="nav-link">技术栈</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cyz.github.io/Applet/" class="nav-link router-link-exact-active router-link-active">小程序</a></li><li class="dropdown-item"><!----> <a href="/cyz.github.io/other/" class="nav-link">其他</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Fishcyz" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/cyz.github.io/Applet/" class="active sidebar-link">小程序开发基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#小程序基础架构" class="sidebar-link">小程序基础架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#开发者工具" class="sidebar-link">开发者工具</a></li><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#小程序开发语言" class="sidebar-link">小程序开发语言</a></li><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#小程序项目相关知识" class="sidebar-link">小程序项目相关知识</a></li><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#组件和插件" class="sidebar-link">组件和插件</a></li></ul></li><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#小程序开发基础" class="sidebar-link">小程序开发基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#数据驱动" class="sidebar-link">数据驱动</a></li><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#事件绑定和处理" class="sidebar-link">事件绑定和处理</a></li><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#小程序的事件驱动和数据绑定模型" class="sidebar-link">小程序的事件驱动和数据绑定模型</a></li><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#路由" class="sidebar-link">路由</a></li><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#javascript-的限制和增强" class="sidebar-link">JavaScript 的限制和增强</a></li></ul></li><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#小程序布局相关知识" class="sidebar-link">小程序布局相关知识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#rpx" class="sidebar-link">rpx</a></li><li class="sidebar-sub-header"><a href="/cyz.github.io/Applet/#flex-布局" class="sidebar-link">flex 布局</a></li></ul></li></ul></li><li><a href="/cyz.github.io/Applet/CloudServices.html" class="sidebar-link">小程序云开发基础</a></li><li><a href="/cyz.github.io/Applet/Framework.html" class="sidebar-link">小程序架构及其实现机制</a></li></ul> </div> <div class="page"> <div class="content"><h2 id="小程序基础架构"><a href="#小程序基础架构" aria-hidden="true" class="header-anchor">#</a> 小程序基础架构</h2> <h3 id="开发者工具"><a href="#开发者工具" aria-hidden="true" class="header-anchor">#</a> 开发者工具</h3> <h4 id="开发界面主要由三部分组成：模拟器、编辑器和调试器"><a href="#开发界面主要由三部分组成：模拟器、编辑器和调试器" aria-hidden="true" class="header-anchor">#</a> 开发界面主要由三部分组成：模拟器、编辑器和调试器</h4> <ul><li>模拟器：提供小程序的运行环境，模拟小程序在手机上的界面效果</li> <li>编辑器：简单 IDE 功能，点击左侧树形菜单可以打开多个文件直接编写保存，做到实时预览效果，但是开发者工具的编辑器做得比较简单，而且使用体验并不好，建议选择自己顺手的 IDE 增加 WXML 和 WXSS 的语法高亮插件等来编辑代码</li> <li>调试器：订制版的 Chrome 开发者工具，提供从页面结构到网络请求等多个面板支持，会用 Chrome DevTools 就很容易上手该工具</li></ul> <blockquote><p>Tips： 常用 IDE 推荐</p> <ul><li>VS Code + minapp 插件</li> <li>Sublime Text 3 + Sublime wxapp 插件</li> <li>Vim + wxapp</li></ul></blockquote> <h4 id="开发、编译、测试和上线相关的（常用）"><a href="#开发、编译、测试和上线相关的（常用）" aria-hidden="true" class="header-anchor">#</a> 开发、编译、测试和上线相关的（常用）</h4> <ul><li>预览、远程调试：是可以在手机上直接预览效果，开启远程 debug 功能的</li> <li>清缓存：对于一些授权登录、缓存、数据之类的操作，我们需要清理状态和数据，可以通过这个按钮操作</li> <li>上传：如果是创建项目的时候填写了 AppID，那么会出现这个按钮，小程序开发完毕后可以通过这个来上传，上传之后可以在小程序后台申请测试版和审核，审核通过后就可以正式上线了</li></ul> <h4 id="开发者工具右上角的「详情」"><a href="#开发者工具右上角的「详情」" aria-hidden="true" class="header-anchor">#</a> 开发者工具右上角的「详情」</h4> <ul><li>项目设置：这个是用得比较多的，可以指定上传代码时候的编译情况，比如支持 ES6 语法、支持 css autoprefixer、代码压缩等</li> <li>域名信息：小程序的 request 等访问的域名采用了白名单形式，在这里可以看到小程序管理后台设置的域名白名单</li> <li>腾讯云状态：可以看到小程序账号和腾讯云的绑定情况</li></ul> <h3 id="小程序开发语言"><a href="#小程序开发语言" aria-hidden="true" class="header-anchor">#</a> 小程序开发语言</h3> <ul><li>WXML：小程序自己发明的 XML 语法描述，用来构造小程序的页面结构</li> <li>WXSS：小程序的页面的样式表语言，描述 WXML 的样式</li> <li>JavaScript：小程序 JS 的执行环境并不是普通的 WebView 浏览器，也不是 Node.js 环境，它执行在微信 App 内上下文， 跟 Node.js 一样，也不能像在浏览器内一样对页面 DOM 进行操作</li></ul> <h4 id="微信小程序运行在三端：ios、android-和用于调试的开发者工具"><a href="#微信小程序运行在三端：ios、android-和用于调试的开发者工具" aria-hidden="true" class="header-anchor">#</a> 微信小程序运行在三端：iOS、Android 和用于调试的开发者工具</h4> <ul><li>在 iOS 上，小程序的 JavaScript 代码运行在 JavaScriptCore 中</li> <li>在 Android 上，小程序的 JavaScript 代码通过 X5 内核来解析</li> <li>在 开发工具上， 小程序的 JavaScript 代码运行在 NW.js（Chromium 内核） 中</li></ul> <h3 id="小程序项目相关知识"><a href="#小程序项目相关知识" aria-hidden="true" class="header-anchor">#</a> 小程序项目相关知识</h3> <h4 id="目录结构"><a href="#目录结构" aria-hidden="true" class="header-anchor">#</a> 目录结构</h4> <ul><li>.json 后缀的 JSON 配置文件</li> <li>.wxml 后缀的 WXML 模板文件</li> <li>.wxss 后缀的 WXSS 样式文件</li> <li>.js 后缀的 JS 脚本逻辑文件</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>├── app.js            小程序全局app相关js
├── app.json          小程序配置文件
├── app.wxss          小程序全局app样式
├── cloud-functions   云函数目录
│   ├── decrypt
│   ├── geocoder
│   ├── he-air
│   ├── he-weather
│   ├── jscode2session
│   └── weather
├── components        组件库
│   └── icon
├── images            图片等静态资源
│   └── cloud.jpg
├── pages             页面目录
│   ├── diary
│   └── weather
└── project.config.json  工具项目配置文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="配置"><a href="#配置" aria-hidden="true" class="header-anchor">#</a> 配置</h4> <ul><li>project.config.json（工具项目配置）：这个是配置项目工具相关的，比如开发者工具的编译设置（是否使用 ES6 语法等）、界面设置，以及云函数相关的 cloudfunctionRoot，详细可以参考项目配置文件</li> <li>papp.json（小程序配置）：小程序的全局配置，包括了所有页面路径、界面表现、网络超时时间、底部 tab、插件等，常用的两个配置是 window 和 pages，详细配置参考全局配置</li> <li>ppage.json（单页面配置）：是相对于 app.json 更细粒度的单页面配置，详细参考页面配置</li></ul> <h3 id="组件和插件"><a href="#组件和插件" aria-hidden="true" class="header-anchor">#</a> 组件和插件</h3> <h4 id="组件"><a href="#组件" aria-hidden="true" class="header-anchor">#</a> 组件</h4> <pre><code>小程序的组件根据实现不同，可以分为 Web 组件和 Native 组件，Web 组件是由 HTML5 原生 Web 组件封装的组件，Native 组件是为了增强小程序的体验，用客户端技术实现的组件，包括一些交互复杂、原生 Web 组件性能不高的组件。
</code></pre> <h5 id="小程序一共提供-8-大类-30-多个组件："><a href="#小程序一共提供-8-大类-30-多个组件：" aria-hidden="true" class="header-anchor">#</a> 小程序一共提供 8 大类 30 多个组件：</h5> <ul><li>视图容器：主要是实现页面布局的，对常见的布局形式进行了封装，比如滚动 sroll-view 等</li> <li>基本内容：类似 HTML5 中内容相关的 p、em 等</li> <li>表单相关：要比 HTML5 的 form 表单丰富一些</li> <li>导航：类似 a 标签</li> <li>媒体：类比 HTML5 中的 video、audio 和 img 等，但是提供更标准的界面和更丰富的 API 支持</li> <li>画布：Native 实现的 Canvas</li> <li>地图：结合腾讯地图数据 Native 实现的组件</li> <li>开放能力：这部分组件偏通用和小程序业务</li></ul> <h4 id="自定义组件"><a href="#自定义组件" aria-hidden="true" class="header-anchor">#</a> 自定义组件</h4> <p>自定义公共组件放在 components 目录下面，这样此小程序的任何页面如果要使用这个公共组件，只需在自己的 page.json 中添加如下字段：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;usingComponents&quot;: {
  &quot;name&quot;: &quot;../../components/name/index&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>添加完成之后，在页面代码中就可以直接使用。</p> <h4 id="插件"><a href="#插件" aria-hidden="true" class="header-anchor">#</a> 插件</h4> <p>插件是对一组 JS 接口、自定义组件或页面的封装，用于提供给第三方小程序调用。简单来说，插件是组件的升级版本，组件只能在自己项目中使用，插件则更独立，是可以发布到全网，供其他开发者使用的。使用插件，则需要在 app.json 中增加 plugins 字段：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;plugins&quot;: {
  &quot;name&quot;: {
    &quot;version&quot;: &quot;1.1.3&quot;,
    &quot;provider&quot;: &quot;wx92c68dae5a8bb046&quot;
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="小程序开发基础"><a href="#小程序开发基础" aria-hidden="true" class="header-anchor">#</a> 小程序开发基础</h2> <h3 id="数据驱动"><a href="#数据驱动" aria-hidden="true" class="header-anchor">#</a> 数据驱动</h3> <p>微信小程序是数据驱动模型，在 WXML 中可以对页面的数据进行绑定，小程序的 WXML 内使用的是 Mustache 语法，在 {{}} 内可以将变量名包裹起来。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;view&gt;{{ message }}&lt;/view&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>Page({
  data: {
    message: 'Hello MINA!'
  }
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>但是小程序不支持复杂的表达式，目前支持简单的三元、加减和逻辑判断，如果要使用形如 NaN 的函数调用语法，需要 WXS 支持：</p> <ol><li>XML 内容：</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;wxs src=&quot;./demo.wxs&quot; module=&quot;tools&quot; /&gt;
&lt;view&gt;{{ tools.toNumber(num) }}&lt;/view&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li>WXS 内容：</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>// demo.wxs
function toNumber(n){
  return parseInt(n)
}
module.exports.toNumber = toNumber
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="3"><li>小程序内对页面的数据修改<strong>只能通过 setData 方法</strong>，不能使用直接赋值的方式 this.data.key = value</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>Page({
  data: {
    message: 'Hello MINA!'
  },
  onLoad(){
    this.setData({
      message: 'hello world~'
    })
  }
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="事件绑定和处理"><a href="#事件绑定和处理" aria-hidden="true" class="header-anchor">#</a> 事件绑定和处理</h3> <h4 id="tap-类的事件"><a href="#tap-类的事件" aria-hidden="true" class="header-anchor">#</a> tap 类的事件</h4> <table><thead><tr><th>事件名称</th> <th>说明</th></tr></thead> <tbody><tr><td>tap</td> <td>手指触摸后马上离开</td></tr> <tr><td>longpress</td> <td>手指触摸后，超过 350ms 再离开，如果指定了事件回调函数并触发了这个事件，tap 事件将不被触发</td></tr> <tr><td>longtap</td> <td>手指触摸后，超过 350ms 再离开（推荐使用 longpress 事件代替）</td></tr></tbody></table> <p>小程序内，事件的绑定是通过在 WXML 标签增加 bind* 属性来实现的</p> <h4 id="事件冒泡"><a href="#事件冒泡" aria-hidden="true" class="header-anchor">#</a> 事件冒泡</h4> <p>小程序内的事件分为可冒泡和不可冒泡的事件，除了 submit、input 之类的事件，多数是可冒泡的事件，对于事件的绑定，除了 bind* 的方式，还可以通过 catch* 的方式来绑定，两者的区别在于：</p> <ul><li>bind 不会阻止冒泡，变形写法为 bind:*</li> <li>catch 会阻止事件继续冒泡，变形写法为 catch:*</li></ul> <h4 id="事件捕获"><a href="#事件捕获" aria-hidden="true" class="header-anchor">#</a> 事件捕获</h4> <p>小程序内，触摸类事件支持捕获阶段，捕获是先于冒泡的触发，绑定捕获事件，可以使用 capture-bind、capture-catch，后者将中断捕获阶段和取消冒泡阶段</p> <blockquote><p>在下面的代码中，点击 inner view 会先后调用 handleTap2、handleTap4、handleTap3、handleTap1。</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;view id=&quot;outer&quot; bind:touchstart=&quot;handleTap1&quot; capture-bind:touchstart=&quot;handleTap2&quot;&gt;
  outer view
  &lt;view id=&quot;inner&quot; bind:touchstart=&quot;handleTap3&quot; capture-bind:touchstart=&quot;handleTap4&quot;&gt;
    inner view
  &lt;/view&gt;
&lt;/view&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>如果将上面代码中的第一个 capture-bind 改为 capture-catch，将只触发 handleTap2。</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;view id=&quot;outer&quot; bind:touchstart=&quot;handleTap1&quot; capture-catch:touchstart=&quot;handleTap2&quot;&gt;
  outer view
  &lt;view id=&quot;inner&quot; bind:touchstart=&quot;handleTap3&quot; capture-bind:touchstart=&quot;handleTap4&quot;&gt;
    inner view
  &lt;/view&gt;
&lt;/view&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="事件对象"><a href="#事件对象" aria-hidden="true" class="header-anchor">#</a> 事件对象</h4> <p>当事件触发时，处理函数会响应，传入 event 对象，通过 event 对象可以获取事件触发时候的一些信息，包括时间戳、detail 等。</p> <p>因为小程序内的事件绑定都是在 WXML 中实现的，所以传递参数只能通过 WXML 上面的属性值来传递，例如下面的代码中，indexDetail 处理函数需要接收生活指数的名称和详情，来弹出弹层提示，这时候需要在标签上增加 data-xx 这样的属性，data-name 和 data-detail 就是两个属性，通过这两个值，可以在 indexDetail 内 event 对象的 target/currentTarget 的 dataset 获取参数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;view class=&quot;life-style&quot;&gt;
    &lt;view class=&quot;item&quot; wx:for=&quot;{{lifeStyle}}&quot; data-name=&quot;{{item.name}}&quot; data-detail=&quot;{{item.detail}}&quot; bindtap=&quot;indexDetail&quot;&gt;
      &lt;view class=&quot;title&quot;&gt;
        &lt;icon type=&quot;{{item.icon}}&quot;&gt;&lt;/icon&gt;
        {{item.name}}
      &lt;/view&gt;
      &lt;view class=&quot;content&quot;&gt;{{item.info}}&lt;/view&gt;
    &lt;/view&gt;
&lt;/view&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>// weather/index.js
// 响应事件的处理函数
indexDetail(e) {
  const {name, detail} = e.currentTarget.dataset
  wx.showModal({
    title: name,
    content: detail,
    showCancel: false
  })
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>按照官方文档，target 和 currentTarget 都有个 dataset，正确获取 dataset 的姿势是使用 currentTarget 的，但是有时候 target 和 currentTarget 的数据又是完全一样的，如果这里使用 target 的话，那么有时候点击会弹出弹窗，有时候不会弹出，这两者究竟是怎样的关系呢？官方的解释有点模棱两可：</p> <ul><li>target：触发事件的源组件</li> <li>currentTarget：事件绑定的当前组件</li></ul> <p>这里笔者做下详细解释：</p> <ul><li>target：触发事件的源组件，上面的代码中，target 可能是 view.title、view.content、view.item 任意触发事件的组件</li> <li>currentTarget：事件绑定的当前组件，上面的代码中，只能是真正绑定了 bindtap 的 view.item</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;view id=&quot;outer&quot; bindtap=&quot;handleTap1&quot;&gt;
  outer view
  &lt;view id=&quot;middle&quot; catchtap=&quot;handleTap2&quot;&gt;
    middle view
    &lt;view id=&quot;inner&quot; bindtap=&quot;handleTap3&quot;&gt;
      inner view
    &lt;/view&gt;
  &lt;/view&gt;
&lt;/view&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>点击 inner view 时，handleTap3 收到的事件对象 target 和 currentTarget 都是 inner，而 handleTap2 收到的事件对象 target 就是 inner，currentTarget 就是 middle。</p> <blockquote><p>target 是事件触发源头的地方，即事件开始的地方，可以冒泡到父节点触发父节点的绑定事件；而 currentTarget 是开发者自己绑定事件的地方，即实际的绑定事件的节点。所以，如果绑定的事件有子节点，那么 target 不会等于 currentTarget，有可能是冒泡触发的，由此可见，获取 dataset 的时候使用 currentTarget 是靠谱的。</p></blockquote> <h3 id="小程序的事件驱动和数据绑定模型"><a href="#小程序的事件驱动和数据绑定模型" aria-hidden="true" class="header-anchor">#</a> 小程序的事件驱动和数据绑定模型</h3> <p><img src="data:image/png;base64,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" alt="运行机制" title="运行机制"></p> <h3 id="路由"><a href="#路由" aria-hidden="true" class="header-anchor">#</a> 路由</h3> <p>小程序提供了对应 a 标签和 location 对象的方法：navigator 组件和 wx 中的导航相关函数。</p> <p>在小程序中，路由是由路由栈来维护的，小程序的路由栈中最多维护 5 个页面，这样在 5 个页面内，小程序维护其渲染页面，可以实现快速的切换。</p> <p>小程序中跳转页面可以通过下面两种方式：</p> <ul><li>使用 navigator 组件：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;navigator url=&quot;跳转页面URL&quot; &gt;跳转到新页面&lt;/navigator&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>使用 wx 中的导航相关函数：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;view bindtap=&quot;gotoUrl&quot;&gt;跳转页面&lt;/view&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>Page({
  gotoUrl(){
    let url = 'pages/another/url'
    wx.navigateTo({
      url
    })
  }
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="javascript-的限制和增强"><a href="#javascript-的限制和增强" aria-hidden="true" class="header-anchor">#</a> JavaScript 的限制和增强</h3> <p>小程序的执行环境是没有浏览器了，所以浏览器环境特有的 window 对象、BOM 和 DOM 等相关 API 都存在缺失（有对应的补充 API），小程序的执行环境是类似于 Node.js 的一种执行环境。因为没有浏览器环境，所以跟浏览器相关的操作如 cookie、Ajax 请求（XMLHttpRequest）、DOM 选择器、DOM 事件、路由 history、缓存、设备信息、位置等都不存在，与之相对应的是小程序的私有 API，比如我们在小程序中不能使用 XMLHttpRequest，但是可以使用功能更加强大的 wx.request 方法。</p> <h2 id="小程序布局相关知识"><a href="#小程序布局相关知识" aria-hidden="true" class="header-anchor">#</a> 小程序布局相关知识</h2> <h3 id="rpx"><a href="#rpx" aria-hidden="true" class="header-anchor">#</a> rpx</h3> <p>rpx 是以小程序容器宽度（等于设备宽度）恒等于 750rpx 来做定义的。
|设备|rpx换算 px (屏幕宽度/750)|px 换算 rpx (750/屏幕宽度)
|--|--|
|iPhone 5|1rpx = 0.42px|1px = 2.34rpx
|iPhone 6|1rpx = 0.5px|1px = 2rpx
|iPhone 6 Plus|1rpx = 0.552px|1px = 1.81rpx</p> <p><strong>按照官方建议，让设计师按照 iPhone 6 的视觉稿标准出图即可，即宽度为 750px</strong></p> <h3 id="flex-布局"><a href="#flex-布局" aria-hidden="true" class="header-anchor">#</a> flex 布局</h3> <p>教程：</p> <ul><li><a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html" target="_blank" rel="noopener noreferrer">语法篇<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.ruanyifeng.com/blog/2015/07/flex-examples.html" target="_blank" rel="noopener noreferrer">实例篇<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">3/5/2019, 10:15:32 AM</span></div></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/cyz.github.io/Applet/CloudServices.html">
          小程序云开发基础
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/cyz.github.io/assets/js/app.fa7d83a1.js" defer></script><script src="/cyz.github.io/assets/js/5.aa5682fb.js" defer></script>
  </body>
</html>
